<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>GitOps and Argo - 100 Days Of Kubernetes</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">Overview</li><li class="chapter-item expanded "><a href="../overview.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../contributors.html"><strong aria-hidden="true">2.</strong> Contributors</a></li><li class="chapter-item expanded affix "><li class="part-title">Let's get started</li><li class="chapter-item expanded "><a href="../start/intro-to-k8s.html"><strong aria-hidden="true">3.</strong> Introduction to Kubernetes</a></li><li class="chapter-item expanded "><a href="../start/architecture-overview.html"><strong aria-hidden="true">4.</strong> Kubernetes Architecture</a></li><li class="chapter-item expanded "><a href="../start/pods.html"><strong aria-hidden="true">5.</strong> Kubernetes Pods</a></li><li class="chapter-item expanded "><a href="../start/set-up-cluster.html"><strong aria-hidden="true">6.</strong> Setup Kubernetes Cluster</a></li><li class="chapter-item expanded "><a href="../start/run-pod.html"><strong aria-hidden="true">7.</strong> Run Pods</a></li><li class="chapter-item expanded "><a href="../start/replicas.html"><strong aria-hidden="true">8.</strong> Replica Set</a></li><li class="chapter-item expanded "><a href="../start/deployment.html"><strong aria-hidden="true">9.</strong> Kubernetes Deployment</a></li><li class="chapter-item expanded "><a href="../start/namespaces.html"><strong aria-hidden="true">10.</strong> Namespaces</a></li><li class="chapter-item expanded "><a href="../start/configmaps.html"><strong aria-hidden="true">11.</strong> ConfigMaps</a></li><li class="chapter-item expanded affix "><li class="part-title">Networking</li><li class="chapter-item expanded "><a href="../networking/service.html"><strong aria-hidden="true">12.</strong> Kubernetes Service</a></li><li class="chapter-item expanded "><a href="../networking/ingress.html"><strong aria-hidden="true">13.</strong> Kubernetes Ingress</a></li><li class="chapter-item expanded "><a href="../networking/servicemesh.html"><strong aria-hidden="true">14.</strong> Service Mesh</a></li><li class="chapter-item expanded affix "><li class="part-title">Storage</li><li class="chapter-item expanded "><a href="../storage/volumes.html"><strong aria-hidden="true">15.</strong> Kubernetes Volumes</a></li><li class="chapter-item expanded affix "><li class="part-title">Kubernetes Clusters Overview and Use</li><li class="chapter-item expanded "><a href="../kubernetes-clusters/kind.html"><strong aria-hidden="true">16.</strong> KinD Cluster</a></li><li class="chapter-item expanded "><a href="../kubernetes-clusters/k3s.html"><strong aria-hidden="true">17.</strong> K3s and K3sup</a></li><li class="chapter-item expanded affix "><li class="part-title">Templating & IaC</li><li class="chapter-item expanded "><a href="../templating/kustomize.html"><strong aria-hidden="true">18.</strong> Kustomize</a></li><li class="chapter-item expanded "><a href="../templating/terraform.html"><strong aria-hidden="true">19.</strong> Terraform</a></li><li class="chapter-item expanded "><a href="../templating/crossplane.html"><strong aria-hidden="true">20.</strong> Crossplane</a></li><li class="chapter-item expanded affix "><li class="part-title">Helm</li><li class="chapter-item expanded "><a href="../helm/partone.html"><strong aria-hidden="true">21.</strong> Helm Part 1</a></li><li class="chapter-item expanded "><a href="../helm/partwo.html"><strong aria-hidden="true">22.</strong> Helm Part 2</a></li><li class="chapter-item expanded "><a href="../helm/partthree.html"><strong aria-hidden="true">23.</strong> Helm Part 3</a></li><li class="chapter-item expanded affix "><li class="part-title">Cloud Native Tools and Platforms</li><li class="chapter-item expanded "><a href="../tools/k9s.html"><strong aria-hidden="true">24.</strong> k9s</a></li><li class="chapter-item expanded "><a href="../tools/knative.html"><strong aria-hidden="true">25.</strong> Knative</a></li><li class="chapter-item expanded "><a href="../tools/argo.html" class="active"><strong aria-hidden="true">26.</strong> GitOps and Argo</a></li><li class="chapter-item expanded "><a href="../tools/linkerd.html"><strong aria-hidden="true">27.</strong> Linkerd</a></li><li class="chapter-item expanded affix "><li class="part-title">Observability</li><li class="chapter-item expanded "><a href="../observaility/prometheus.html"><strong aria-hidden="true">28.</strong> Prometheus</a></li><li class="chapter-item expanded "><a href="../observability/prometheus-exporter.html"><strong aria-hidden="true">29.</strong> Prometheus Exporter</a></li><li class="chapter-item expanded affix "><li class="part-title">Advanced Topics</li><li class="chapter-item expanded "><a href="../advanced/operators.html"><strong aria-hidden="true">30.</strong> Kubernetes Operators</a></li><li class="chapter-item expanded affix "><li class="part-title">Tutorials and Practice</li><li class="chapter-item expanded "><a href="../tutorials/serverless.html"><strong aria-hidden="true">31.</strong> Serverless</a></li><li class="chapter-item expanded "><a href="../tutorials/ingress-from-scratch.html"><strong aria-hidden="true">32.</strong> Ingress from scratch</a></li><li class="chapter-item expanded "><a href="../tutorials/istio-from-scratch.html"><strong aria-hidden="true">33.</strong> Istio from scratch</a></li><li class="chapter-item expanded "><a href="../tutorials/deploy-to-civo.html"><strong aria-hidden="true">34.</strong> Depoy to CIVO</a></li><li class="chapter-item expanded affix "><li class="part-title">Troubleshooting K8s</li><li class="chapter-item expanded "><a href="../troubleshooting/crashloopbackoff.html"><strong aria-hidden="true">35.</strong> CrashLoopBackOff</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">100 Days Of Kubernetes</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/100daysofkubernetes/100DaysOfKubernetes" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="gitops-and-argo"><a class="header" href="#gitops-and-argo">GitOps and Argo</a></h1>
<h1 id="100days-resources"><a class="header" href="#100days-resources">100Days Resources</a></h1>
<ul>
<li><a href="https://youtu.be/c4v7wGqKcEY">Video by Anais Urlichs on ArgoCD</a></li>
<li><a href="https://youtu.be/c3qJr6L8nHg">Video by Anais Urlichs on Argo Workflows</a></li>
<li>Add your blog posts, videos etc. related to the topic here!</li>
</ul>
<h1 id="learning-resources"><a class="header" href="#learning-resources">Learning Resources</a></h1>
<ul>
<li><a href="https://thenewstack.io/understanding-gitops-the-latest-tools-and-philosophies/">&quot;Understanding GitOps: The Latest Tools and Philosophies&quot;</a></li>
<li><a href="https://www.youtube.com/c/DevOpsToolkit/videos">The DevOps Toolkit</a> has several great explanations and tutorials around GitOps and ArgoCD</li>
</ul>
<h1 id="example-notes"><a class="header" href="#example-notes">Example Notes</a></h1>
<p>This is the website of Argo <a href="https://argoproj.github.io/">https://argoproj.github.io/</a></p>
<p>Argo is currently a CNCF incubating project. Part of the Argo project family are three different projects:</p>
<ol>
<li><a href="./argo.html#argo-cd">Continuous Delivery</a></li>
<li><a href="./argo.html#argo-workflows">Workflows and Pipelines</a></li>
<li><a href="./argo.html#argo-events">Events</a></li>
<li>Rollouts</li>
</ol>
<p><strong>So why would you want to learn about Argo and all of its projects?</strong></p>
<p>Argo follows best-practices for deploying and monitoring your applications as well as any resources that your application may depend on. Additionally, it is open source, so it will allow you to become familiar with best practices for deployments without having to pay for an expensive tool.</p>
<p>A lot of employers want to see your experience with real-world tools and scenarios. If you do not have access directly to the paid tools that are used in production, your best chance is to get really familiar with the open source tools that are used and available.</p>
<h2 id="argo-cd"><a class="header" href="#argo-cd">Argo CD</a></h2>
<p>A few months ago, I wrote an article <a href="https://thenewstack.io/understanding-gitops-the-latest-tools-and-philosophies/">&quot;Understanding GitOps: The Latest Tools and Philosophies&quot;</a> for the New Stack. In that blog post, I went over the basics of what GitOps is all about and the key facts as of today. </p>
<p>So what is GitOps and why would we want to use it? In its simplest form, GitOps is the principle of defining all of our resources in Git. Meaning, anything that we could possibly push to a Git repository and keep version controlled, we should.</p>
<p><strong>Why do we want to learn about GitOps and implement it in our organisation?</strong></p>
<p>There are different ways to duplicate steps on different machines. We could either go ahead and press different buttons, and detail the process of us setting everything up, or we could go ahead and define our Infrastructure as Code, Kubernetes resources through declarative YAML files and so on.</p>
<p>Using the declarative way to define our resources makes our infrastructure pro-active rather than reactive. This about, instead of zipping through different TV channels, you tell your TV that every Saturday morning at 10 AM you want to watch a cooking show by person x. Ultimately, your TV is going to take care of making that happen.</p>
<p>The main problem with the imperative approach of setting up our resources is that we cannot accurately recreate the same steps. UIs change, buttons move, so how can we ensure that we press the same buttons always.</p>
<p>Additionally, setting up resources the manual way is extremely risky. How do you ensure people do not break things, that the security is correct and the networking is in place?</p>
<p><strong>So how does GitOps actually work?</strong></p>
<p>The two most popular tools right now for GitOps best practices are Flux CD and Argo CD. In both cases, you will install an agent inside your cluster. This agent is then responsible for monitoring your resources.</p>
<p>The desired state of your resources will be defined in Git. Whenever anything changes to your desired state, the Agent will pull the new resources from Git and deploy them to your Kubernetes Cluster. You can call it magic or really good engineering work 🙂</p>
<p><strong>Now why is there a pull model instead of a push model?</strong> </p>
<p>The pull model makes it possible for the agent to deploy new images from inside the cluster; they are pulling information into the cluster rather than the cluster having to allow new information being pushed in from the outside. The latter would open the cluster for new security risks.</p>
<h2 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h2>
<p>In this example, we are going to be using Argo CD to install resources in our cluster. Why are we using Argo and not Flux? I am familiar with Argo but not so familiar with Flux. Additionally, Argo has a really nice UI that will help us understand what is actually happening within our cluster.</p>
<p>Separately, ArgoCD just launched its version 2.0. Note that I will be trying out their 2.0 version for the first time. <a href="https://www.cncf.io/blog/2021/04/07/argo-cd-2-0-released/">https://www.cncf.io/blog/2021/04/07/argo-cd-2-0-released/</a></p>
<p>Documentation: <a href="https://argoproj.github.io/argo-cd/">https://argoproj.github.io/argo-cd/</a></p>
<p>So, let's get started.</p>
<p>Create a new cluster</p>
<pre><code class="language-jsx">kind create cluster --name argocd
</code></pre>
<p>Let's create a namespace for agrocd</p>
<pre><code class="language-jsx">kubectl create namespace argocd
</code></pre>
<p>And install the CRDs that Argo is based on </p>
<pre><code class="language-jsx">kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/v2.0.0-rc3/manifests/install.yaml
</code></pre>
<p>Argo is installed as CRD inside our cluster</p>
<pre><code class="language-jsx">kubectl get all -n argocd
</code></pre>
<p>Now that we have that, we want to access the UI.</p>
<pre><code class="language-jsx">kubectl port-forward svc/argocd-server -n argocd 8080:443
</code></pre>
<p>You can get the password through the following command. Make sure that you port-forwarded beforehand.</p>
<pre><code class="language-jsx">kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath=&quot;{.data.password}&quot; | base64 -d
</code></pre>
<p>And then log into </p>
<pre><code class="language-jsx">argocd login localhost:8080
</code></pre>
<p>This will allow us to update our password — the username is &quot;admin&quot;</p>
<pre><code class="language-jsx">argocd account update-password
</code></pre>
<p>We will open <a href="http://localhost">localhost</a> next and log into the UI.</p>
<p>Let's deploy an application. First, through the UI and then through the CLI. You can install the Argo CD CLI through the following commands:</p>
<pre><code class="language-jsx">VERSION=$(curl --silent &quot;https://api.github.com/repos/argoproj/argo-cd/releases/latest&quot; | grep '&quot;tag_name&quot;' | sed -E 's/.*&quot;([^&quot;]+)&quot;.*/\1/')
curl -sSL -o /usr/local/bin/argocd https://github.com/argoproj/argo-cd/releases/download/$VERSION/argocd-linux-amd64
chmod +x /usr/local/bin/argocd
</code></pre>
<p>Here is the documentation: <a href="https://argoproj.github.io/argo-cd/cli_installation/">https://argoproj.github.io/argo-cd/cli_installation/</a></p>
<p>We are going to be using the following repository</p>
<p><a href="https://github.com/AnaisUrlichs/react-article-display">https://github.com/AnaisUrlichs/react-article-display</a></p>
<p>Now we will go ahead and tell the Argo UI about my Helm Chart. If you already have a repository with a Helm Chart, YAML files, or any other YAML manifests, you could use that instead.</p>
<p>Alternatively, you can tell Argo CD about the repository through the following command or similar:</p>
<pre><code class="language-jsx">argocd app create react-app --repo https://github.com/anais-codefresh/react-article-display.git --path charts/example-chart --dest-server https://kubernetes.default.svc --dest-namespace default
</code></pre>
<p>Once the app has been deployed, we can take a look </p>
<pre><code class="language-jsx">kubectl get all
</code></pre>
<pre><code class="language-jsx">argocd app get react-app
</code></pre>
<p>We can also ensure that our desired state is synced with the actual state in our cluster</p>
<pre><code class="language-jsx">argocd app sync react-app
</code></pre>
<p>So what happens if we make any manual changes with the resources within our cluster?</p>
<p>Let's go ahead and patch the service into type NodePort</p>
<pre><code class="language-jsx">kubectl patch svc react-app-example-chart --type='json' -p '[{&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/type&quot;,&quot;value&quot;:&quot;NodePort&quot;}]'
</code></pre>
<p>And check the status again</p>
<pre><code class="language-jsx">argocd app get react-app
</code></pre>
<h2 id="additional-resources"><a class="header" href="#additional-resources">Additional Resources</a></h2>
<p>If you do not have enough time for all of this, here is a video in which I provide an overview of GitOps in about 1 min</p>
<p><a href="https://youtu.be/H7wex_SmtrI">https://youtu.be/H7wex_SmtrI</a></p>
<h2 id="argo-events"><a class="header" href="#argo-events">Argo Events</a></h2>
<p>Documentation: <a href="https://argoproj.github.io/argo-events/">https://argoproj.github.io/argo-events/</a></p>
<p>Argo events is an event-driven workflow automation framework. This means that there is a trigger/event happening that causes a workflow to run and to use or modify K8s objects in response to the workflow. </p>
<p>Events can come from a variety of sources including webhooks, s3, schedules, messaging queues, gcp pubsub, sns, sqs — and by now I am lost between what these short forms mean. The point being, you can set-up a lot of different events to trigger a workflow.</p>
<p>Here are some of the features that are supported by Argo Events</p>
<ul>
<li>Supports events from 20+ event sources.</li>
<li>Ability to customize business-level constraint logic for workflow automation.</li>
<li>Manage everything from simple, linear, real-time to complex, multi-source events.</li>
<li>Supports Kubernetes Objects, Argo Workflow, AWS Lambda, Serverless, etc. as triggers.</li>
<li><a href="https://cloudevents.io/">CloudEvents</a> compliant.</li>
</ul>
<p>Once the event has been registered, it can then trigger either or multiple of the following:</p>
<ol>
<li>Argo Workflows</li>
<li>Standard K8s Objects</li>
<li>HTTP Requests / Serverless Workloads (OpenFaas, Kubeless, KNative etc.)</li>
<li>AWS Lambda</li>
<li>NATS Messages</li>
<li>Kafka Messages</li>
<li>Slack Notifications</li>
<li>Argo Rollouts</li>
<li>Custom Trigger / Build Your Own Trigger</li>
<li>Apache OpenWhisk</li>
</ol>
<p>Overall, there are 22 different events that can trigger 11 different actions.</p>
<p><strong>Event Source</strong></p>
<p>Listens to an event insides and/or outside of the cluster and once an event has been recorded, it will send it to an eventbus.</p>
<p><strong>Sensor</strong></p>
<p>The sensor listens to the event bus for certain events and conditional triggers actions.</p>
<p><strong>Trigger</strong></p>
<p>What will ultimately happen - the action e.g. our Argo workflow</p>
<p>The eventbus acts as the transport layer of Argo-Events by connecting the event-sources and sensors.</p>
<p>Event-Sources publish the events while the sensors subscribe to the events to execute triggers.</p>
<p>The current implementation of the eventbus is powered by NATS streaming.</p>
<h2 id="argo-workflows"><a class="header" href="#argo-workflows">Argo Workflows</a></h2>
<p>Documentation <a href="https://argoproj.github.io/argo-workflows/">https://argoproj.github.io/argo-workflows/</a></p>
<p>You would not want to use Argo Events solely by itself because by itself it does not provide a lot of functionality. Instead, you want to set-up Argo events with Argo workflows. </p>
<p>Argo Workflows is used to orchestrate parallel jobs on Kubernetes. A workflow in itself is a series of steps that follow each other but can also put in parallel. </p>
<p>In Argo Workflows, each step of the Workflows is its own container. Meaning, you can put anything that you can put into a container image into an Argo Workflow. </p>
<p>Additionally, Argo Worklfows makes it possible to model multi-step workflows as a sequence of tasks and capture dependencies between tasks using a directed acyclic graph (DAG). Meaning, you can have different steps being dependent on one another and tell Argo Worklfows the order of steps.</p>
<p>Making it possible to run CI/CD pipelines natively on Kubernetes is definitely a big plus since that means that everything that we set-up will be placed directly into Kubernetes.</p>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p>The installation of Argo events is similar to all other Argo projects. Namely, we will start out by </p>
<ol>
<li>Creating a namespace</li>
<li>Installing the CRDs and controllers that the specific Argo tool depends on e.g. Argo events </li>
<li>Argo events requires a specific eventbus to be installed </li>
</ol>
<p>First, we want to set-up Argo Workflows by following the getting started guide. </p>
<p>Note that Argo workflows does not work on all clusters. You can try it out on different clusters but you might need a cluster of a cloud provider.</p>
<p>Next, we want to create a namespace for Argo Workflows that we can use to set-up our </p>
<pre><code class="language-jsx">kubectl create ns argo
kubectl apply -n argo -f https://raw.githubusercontent.com/argoproj/argo-workflows/stable/manifests/quick-start-postgres.yaml
</code></pre>
<p>You can then access the Argo Workflows UI though the following command on localhost:2746</p>
<pre><code class="language-jsx">kubectl -n argo port-forward deployment/argo-server 2746:2746
</code></pre>
<p>Then we are going to go ahead and set-up Argo events — we are going to go with the cluster wide installation but you can also choose the namespace specific installation. Please have a look at the documentation for that.</p>
<pre><code class="language-jsx">kubectl create namespace argo-events
kubectl apply -f https://raw.githubusercontent.com/argoproj/argo-events/stable/manifests/install.yaml
</code></pre>
<p>Then, we will need the eventbus</p>
<pre><code class="language-jsx">kubectl apply -n argo-events -f https://raw.githubusercontent.com/argoproj/argo-events/stable/examples/eventbus/native.yaml
</code></pre>
<p>Before you move to the next step, please make sure to have all the eventbus related pods running in your argo-events namespace</p>
<pre><code class="language-jsx">kubectl get all -n argo-events
</code></pre>
<p>Now we will set-up an event source for webhooks. Note that you can also set-up other event sources</p>
<pre><code class="language-jsx">kubectl apply -n argo-events -f https://raw.githubusercontent.com/argoproj/argo-events/stable/examples/event-sources/webhook.yaml
</code></pre>
<p>Here is the webhook YAML <a href="https://raw.githubusercontent.com/argoproj/argo-events/stable/examples/event-sources/webhook.yaml">https://raw.githubusercontent.com/argoproj/argo-events/stable/examples/event-sources/webhook.yaml</a> </p>
<p>Now create a sensor for the webhook</p>
<pre><code class="language-jsx">kubectl apply -n argo-events -f https://raw.githubusercontent.com/argoproj/argo-events/stable/examples/sensors/webhook.yaml
</code></pre>
<p>Have a look at the way the sensor defines the workflow here <a href="https://raw.githubusercontent.com/argoproj/argo-events/stable/examples/sensors/webhook.yaml">https://raw.githubusercontent.com/argoproj/argo-events/stable/examples/sensors/webhook.yaml</a></p>
<p>Access the event-source pod via port forward to consumer requests over HTTP</p>
<pre><code class="language-jsx">kubectl -n argo-events port-forward $(kubectl -n argo-events get pod -l eventsource-name=webhook -o name) 12000:12000 &amp;
</code></pre>
<p>Now send a request to localhost:12000</p>
<pre><code class="language-jsx">curl -d '{&quot;message&quot;:&quot;this is my first webhook&quot;}' -H &quot;Content-Type: application/json&quot; -X POST http://localhost:12000/example
</code></pre>
<p>And verify that an Argo workflows was triggered</p>
<pre><code class="language-jsx">kubectl -n argo-events get workflows | grep &quot;webhook&quot;
</code></pre>
<pre><code class="language-jsx">kubectl -n argo-events get wf
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../tools/knative.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../tools/linkerd.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../tools/knative.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../tools/linkerd.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
